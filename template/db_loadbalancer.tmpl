#AUTO_GENERATED BY TERRAFORM DO NOT MODIFY THE OUTPUT


load_module /usr/lib/nginx/modules/ngx_stream_module.so;

events {
    worker_connections 1024;
}
stream {
    upstream db {
        server ${db_master}:3306;
        server ${db_slave}:3306 backup;
    }

    server {
        listen 3306;
        proxy_pass db;
        proxy_connect_timeout 1s; # detect failure quickly
    }
}