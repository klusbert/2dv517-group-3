load_module /usr/lib/nginx/modules/ngx_stream_module.so;
events {
    worker_connections 1024;
}
http {
    upstream wordpress {
        #server srv1.example.com;
        #server srv2.example.com;
        #server srv3.example.com;
        server 192.168.199.13;
        server 192.168.199.7;
        server 192.168.199.10;

    }

    server {
        listen 80;

        location / {
            proxy_pass http://wordpress;
        }
    }
}

stream {
    upstream db {
        server 192.168.199.9:3306;
        server 192.168.199.5:3306 backup;
    }

    server {
        listen 3306;
        proxy_pass db;
        proxy_connect_timeout 1s; # detect failure quickly
    }
}